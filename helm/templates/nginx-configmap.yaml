# nginx-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: isd-wiki-nginx-config
  labels:
    app.kubernetes.io/name: isd-wiki
    app.kubernetes.io/instance: isd-wiki
data:
  nginx.conf: |
    events {
      worker_connections  1024;
    }
    http {
      include       /etc/nginx/mime.types;
      default_type  application/octet-stream;
      sendfile        on;
      keepalive_timeout  65;
      server {
        listen 80;
        server_name  _;
        root   /var/www/html;
        index  index.php;
        location / {
          try_files $uri $uri/ =404;
        }
        # New location block for static assets
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires max;
            log_not_found off;
        }
        location ~ \.php$ {
          fastcgi_pass   localhost:9000;
          fastcgi_index  index.php;
          fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
          include        fastcgi_params;
        }
      }
    }